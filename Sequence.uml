@startuml

participant Пользователь
participant Браузер
participant DNS_сервер
participant Сервер

Пользователь -> Браузер : Ввод google.com в адресную строку
Activate Браузер
Браузер -> Браузер : Парсинг URL

Браузер -> Браузер : Проверка списка HSTS

Alt Сайт присутствует в списке HSTS

Браузер -> Браузер : Проверка файла hosts

Alt Домен присутствует в файле hosts

Браузер -> Браузер : Проверка домена в своем кэше

Else Домен отсутствует в файле hosts

Alt Если DNS-сервер находится в той же подсети
Браузер -> DNS_сервер : ARP-запрос
Activate DNS_сервер
Браузер <-- DNS_сервер : ARP-ответ
Deactivate DNS_сервер
Else Если DNS-сервер находится в другой подсети
Браузер -> Браузер : ARP-запрос отправляется на IP-адрес шлюза по умолчанию
end
end

Браузер -> Браузер : Запрос потока TCP-сокета
Браузер -> Браузер : Ответ на запрос потока TCP-сокета
Браузер -> Сервер : Запрос TLS handshake
Activate Сервер
Сервер --> Браузер : Ответ на TLS handshake
Deactivate Сервер
Браузер -> Сервер : Отправление HTTP-запроса
Activate Сервер

Alt HTTP-заголовки отсутствуют в кэше браузера

Сервер --> Браузер : Отправление HTML-страницы

Else HTTP-заголовки присутствуют в кэше браузера
Браузер -> Браузер : Загрузка HTML-страницы из кэша
end

Deactivate Сервер

Браузер -> Браузер : Парсинг HTML
Браузер -> Браузер : Интерпретация CSS
Браузер -> Браузер : Рендеринг страницы
Браузер -> Браузер : Исполнение JavaScript-кода
Браузер --> Пользователь : Отображение страницы

else Если сайт отсутствует в списке HSTS, но использует политику HSTS

Браузер --> Пользователь: Ответ о необходимости использования HTTPS

end

Deactivate Браузер

@enduml